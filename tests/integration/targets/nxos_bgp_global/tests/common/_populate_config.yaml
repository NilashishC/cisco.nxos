- name: "Setup - 1"
  cisco.nxos.nxos_config:
    lines:
      - "router bgp 65563"
      - "bestpath as-path multipath-relax"
      - "bestpath compare-neighborid"
      - "bestpath cost-community ignore"
      - "confederation identifier 42"
      - "log-neighbor-changes"
      - "maxas-limit 20"
      - "neighbor-down fib-accelerate"
      - "router-id 192.168.1.1"
      - "confederation peers 65020 65030 65040"
      - "neighbor 192.168.1.100"
      - "  remote-as 65563"
      - "  affinity-group 160"
      - "  description NBR-1"
      - "  low-memory exempt"
      - "neighbor 192.168.1.101"
      - "  remote-as 65564"
      - "  password 7 12090404011C03162E"
  vars:
    ansible_connection: ansible.netcommon.network_cli

- name: "Setup - 2"
  cisco.nxos.nxos_config:
    lines:
      - "vrf site-2"
      - "  local-as 300"
      - "  log-neighbor-changes"
      - "  neighbor-down fib-accelerate"
      - "  neighbor 203.0.113.2"
      - "    remote-as 65568"
      - "    description site-2-nbr-1"
      - "    password 3 AF92F4C16A0A0EC5BDF56CF58BC030F6"
    parents: "router bgp 65563"
  vars:
    ansible_connection: ansible.netcommon.network_cli

- name: "Setup - 3"
  cisco.nxos.nxos_config:
    lines:
      - "vrf site-1"
      - "  local-as 200"
      - "  log-neighbor-changes"
      - "  neighbor 198.51.100.1"
      - "    remote-as 65562"
      - "    description site-1-nbr-1"
      - "    password 3 13D4D3549493D2877B1DC116EE27A6BE"
      - "  neighbor 198.51.100.2"
      - "    remote-as 65562"
      - "    description site-1-nbr-2"
    parents: "router bgp 65563"
  vars:
    ansible_connection: ansible.netcommon.network_cli